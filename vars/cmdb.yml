######## 
# CMDB #
########

# # Juniper (show)
# vlans:
#   - name: Vlan_1
#     vlan_id: 1
#   - name: Vlan_10
#     vlan_id: 10
#   - name: Vlan_20
#     vlan_id: 20
#   - name: Vlan_101
#     vlan_id: 101
#   - name: Vlan_102
#     vlan_id: 102
#   - name: Vlan_103
#     vlan_id: 103
#   - name: Vlan_104
#     vlan_id: 104

# # Juniper (show interfaces status)
# l2_interfaces_juniper:
#   - name: gr-0/0/0
#     access:
#       vlan: 1
#   - name: ip-0/0/0
#     access:
#       vlan: 1

# Juniper (show ; show interface)
l3_interfaces_juniper:
  - name: ge-0/0/0
    ipv4:
    - address: 10.0.1.88/24
  - name: ge-0/0/1
    ipv4:
      - address: 10.0.2.225/24

    # - name: Create security zone "trust"
    #   junipernetworks.junos.junos_security_zone:
    #     name: trust
    #     interfaces:
    #       - name: ge-0/0/1.0
    #     state: merged

    # - name: Create security zone "untrust"
    #   junipernetworks.junos.junos_security_zone:
    #     name: untrust
    #     interfaces:
    #       - name: ge-0/0/2.0
    #     state: merged

srx_fw_rules:
    name: Security_Policy_1
    from_zones:
      - zone_name: public
    to_zones:
      - zone_name: private
    policies:
      - name: policy1
        description: "Allow traffic from trust to untrust"
        match:
          source_address:
            - "192.168.1.0/24"
          destination_address:
            - "10.0.0.0/24"
          application:
            - "junos-ssh"
        then:
          permit: true

srx_fw_rules2:
  - name: Rule_A
    src:
      zone: "public"
      addresses:
        - name: "inside_host_D"
          ipv4: "10.10.2.3"
    dest:
      zone: "private"
      addresses:
        - name: "pub_host_A"
          type: host
          ipv4: "7.7.7.1"
        - name: "pub_host_B"
          type: host
          ipv4: "7.7.7.2"
    services:
      - http
      - https
    rule:
      action: "Accept"
  - name: Rule_B
    src:
      zone: "public"
      addresses:
        - name: "pub_host_E"
          type: host
          ipv4: "7.7.7.3"
        - name: "pub_host_F"
          type: host
          ipv4: "7.7.7.4"
    dest:
      zone: "private"
      addresses:
        - name: "inside_host_C"
          ipv4: "10.10.2.4"
    services:
      - http
      - https
    rule:
      action: "Accept"


  # - name: rule_C
  #   src:
  #     addresses:
  #       - name: "pub_host_A"
  #         type: host
  #         ipv4: "7.7.7.1"
  #       - name: "pub_host_B"
  #         type: host
  #         ipv4: "7.7.7.2"
  #   dest:
  #     addresses:
  #       - name: "inside_host_D"
  #         ipv4: "10.10.2.3"
  #   services:
  #     - http
  #     - https
  #   rule:
  #     action: "Accept"
  # - name: rule_D
  #   inout: in
  #   src:
  #     interface: "inside"
  #     addresses:
  #       - name: "inside_host_C"
  #         ipv4: "10.10.2.4"
  #   dest:
  #     addresses:
  #       - name: "pub_host_E"
  #         type: host
  #         ipv4: "7.7.7.3"
  #       - name: "pub_host_F"
  #         type: host
  #         ipv4: "7.7.7.4"
  #   services:
  #     - http
  #     - https
  #   rule:
  #     action: "Accept"